<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.4. The Laplace equation in all its forms &#8212; Numerical tours in scientific computing</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=8203d6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=25db1f2b" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gen.css?v=1d84c916" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>window.MathJax = {"tex": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "macros": {"calA": "{{\\mathcal A}}", "calC": "{{\\mathcal C}}", "calI": "{{\\mathcal I}}", "calF": "{{\\mathcal F}}", "calL": "{{\\mathcal L}}", "bz": "{\\mathbf{0}}", "d": "{\\text{d}}", "dv": "{\\text{div}}", "e": "{\\varepsilon}", "be": "{\\textbf{e}}", "n": "{\\textbf{n}}", "t": "{\\textbf{t}}", "f": "{\\textbf{f}}", "g": "{\\textbf{g}}", "u": "{\\textbf{u}}", "m": "{\\textbf{m}}", "v": "{\\textbf{v}}", "p": "{\\textbf{p}}", "bj": "{\\textbf{j}}", "bC": "{\\textbf{C}}", "bF": "{\\textbf{F}}", "bU": "{\\textbf{U}}", "bV": "{\\textbf{V}}", "x": "{\\textbf{x}}", "y": "{\\textbf{y}}", "bX": "{\\textbf{X}}", "P": "{\\mathbb{P}}", "R": "{\\mathbb{R}}", "N": "{\\mathbb{N}}", "I": "{\\text{I}}", "Id": "{\\text{Id}}", "o": "{\\text{o}}", "calT": "{{\\mathcal T}}", "Hdiv": "{H_{\\text{div}}}", "tr": "{\\text{tr}}", "bold": ["{\\bf #1}", 1]}, "loader": {"load": ["[tex]/boldsymbol"]}, "packages": {"[+]": ["boldsymbol"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1.5. Visualization of meshes and solutions" href="visualization.html" />
    <link rel="prev" title="1.3. An introduction to the Finite Element method" href="FEtheory.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="the-laplace-equation-in-all-its-forms">
<span id="sec-lap"></span><h1><span class="section-number">1.4. </span>The Laplace equation in all its forms<a class="headerlink" href="#the-laplace-equation-in-all-its-forms" title="Link to this heading">¶</a></h1>
<p>This section is devoted to the numerical solution of the Laplace equation and of several variants. This task serves as an excuse to introduce the numerical environment <span class="math notranslate nohighlight">\(\texttt{FreeFem}\)</span>, which is the pivotal numerical tool used in this series of tutorials.
Briefly, <span class="math notranslate nohighlight">\(\texttt{FreeFem}\)</span> is an open-source environment, which conveniently allows to solve boundary value problems within a few lines of commands. This is achieved through the direct input of their variational formulations, via a simple pseudo-language which is close to the mathematical writing.</p>
<p><span class="math notranslate nohighlight">\(\texttt{FreeFem}\)</span> can be downloaded from the <a class="reference external" href="https://freefem.org/">dedicated website</a>. This section introduces the main commands, and slightly more advanced features of <span class="math notranslate nohighlight">\(\texttt{FreeFem}\)</span> will be described in the course of the next tutorials.
The reader is referred to the complete <a class="reference external" href="https://doc.freefem.org">online documentation</a> of <span class="math notranslate nohighlight">\(\texttt{FreeFem}\)</span>, and the rich collection of examples worked in there for questions and further issues.</p>
<section id="motivation-modeling-of-thermal-phenomena-with-the-laplace-equation">
<span id="sec-laplacemod"></span><h2><span class="section-number">1.4.1. </span>Motivation: modeling of thermal phenomena with the Laplace equation<a class="headerlink" href="#motivation-modeling-of-thermal-phenomena-with-the-laplace-equation" title="Link to this heading">¶</a></h2>
<p>Before starting our tour properly speaking, we feel obliged to say a few words about the physics behind the Laplace equation; the reader eager to discover implementation aspects may skip this section.</p>
<p>The Laplace equation serves as (often simplified) mathematical model for a wide variety of physical phenomena: it describes notably the flow of current in an electrostatic conductor, the vertical displacement of an elastic membrane, or the behavior of the temperature within a domain, as we present in this section.</p>
<p>The situation is depicted on <a class="reference internal" href="#fig-physlap"><span class="std std-numref">Fig. 1.7</span></a>: <span class="math notranslate nohighlight">\(\Omega\)</span> be a bounded and Lipschitz domain in <span class="math notranslate nohighlight">\(\R^d\)</span>, where <span class="math notranslate nohighlight">\(d=2\)</span> or <span class="math notranslate nohighlight">\(3\)</span>;
a heat source with density <span class="math notranslate nohighlight">\(f: \Omega \to \R\)</span> is acting inside <span class="math notranslate nohighlight">\(\Omega\)</span>, accounting for instance for the generation of heat via the disintegration of radioactive particles.</p>
<figure class="align-default" id="id1">
<span id="fig-physlap"></span><a class="reference internal image-reference" href="../_images/physLap.png"><img alt="../_images/physLap.png" src="../_images/physLap.png" style="width: 577.8px; height: 427.2px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1.7 </span><span class="caption-text">A thermal cavity <span class="math notranslate nohighlight">\(\Omega\)</span>, and the heat flux vector <span class="math notranslate nohighlight">\(\bj\)</span> within.</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>The physical phenomenon at play is described by:</p>
<blockquote>
<div><ul>
<li><p>The temperature field <span class="math notranslate nohighlight">\(u:\Omega \to \R\)</span>.</p></li>
<li><p>The heat flux <span class="math notranslate nohighlight">\(\bj : \Omega \to \R^d\)</span>: by definition, the thermal energy crossing a surface <span class="math notranslate nohighlight">\(S \subset \R^d\)</span> with unit normal vector <span class="math notranslate nohighlight">\(\n\)</span> equals</p>
<p><div class="math notranslate nohighlight">
\[\int_S \bj \cdot \n \:\d s.\]</div>
</p>
</li>
</ul>
</div></blockquote>
<p>The first important ingredient in the modeling of thermal effects is Fourier’s law, which relates the heat flux <span class="math notranslate nohighlight">\(\bj\)</span> to the temperature <span class="math notranslate nohighlight">\(u\)</span>:</p>
<p><div class="math notranslate nohighlight">
\[\bj(\x) = - \gamma(\x)\nabla u(\x). \]</div>
</p>
<p>According to intuition, heat is flowing from regions with high temperature to those with low temperature. The coefficient <span class="math notranslate nohighlight">\(\gamma\)</span> is called thermal conductivity, and it depends on the physical properties of the constituent material of <span class="math notranslate nohighlight">\(\Omega\)</span>: high conductivity media, such as metals, are the site of intense heat flow when compared to low conductivity materials, such as air or wool.</p>
<p>The second key ingredient in the modeling is to relate the heat flux <span class="math notranslate nohighlight">\(\bj\)</span> to the production of heat inside <span class="math notranslate nohighlight">\(\Omega\)</span> by the source <span class="math notranslate nohighlight">\(f\)</span>. To achieve this, let us consider a small, arbitrary subdomain <span class="math notranslate nohighlight">\(\omega \Subset \Omega\)</span>. The heat within <span class="math notranslate nohighlight">\(\omega\)</span> is changing via two mechanisms:</p>
<blockquote>
<div><ul>
<li><p>Heat is entering (or escaping) through the boundary <span class="math notranslate nohighlight">\(\partial \omega\)</span> under the effect of the temperature difference with the outer medium. The amount of heat flowing in this way equals
<div class="math notranslate nohighlight">
\[-\int_{\partial \omega} \bj \cdot \n \:\d s.\]</div>
</p>
<p>Note that the minus sign ensures that heat is gained by <span class="math notranslate nohighlight">\(\omega\)</span> when <span class="math notranslate nohighlight">\(\bj \cdot \n &lt; 0\)</span>, i.e. when <span class="math notranslate nohighlight">\(\bj\)</span> is pointing inside <span class="math notranslate nohighlight">\(\omega\)</span>.</p>
</li>
<li><p>The amount of heat produced by the volumic source equals <span class="math notranslate nohighlight">\(\int_\omega f \:\d \x\)</span>.</p></li>
</ul>
</div></blockquote>
<p>We now assume that the system is at equilibrium: no change can occur in the heat contained in <span class="math notranslate nohighlight">\(\omega\)</span> and both effects must compensate. This writes:</p>
<p><div class="math notranslate nohighlight">
\[-\int_{\partial \omega} \bj \cdot \n \:\d s + \int_\Omega f \:\d \x = 0 .\]</div>
</p>
<p>Using <a class="reference internal" href="anafunc.html#sec-green"><span class="std std-ref">Green’s’ formula</span></a>, we arrive at:</p>
<p><div class="math notranslate nohighlight">
\[-\int_{\omega} \dv(\bj) \:\d \x + \int_\Omega f \:\d \x = 0 .\]</div>
</p>
<p>Since this holds for an arbitrary subdomain <span class="math notranslate nohighlight">\(\omega\)</span>, we arrive at:</p>
<p><div class="math notranslate nohighlight">
\[\dv(\bj) = f, \text{ that is } -\dv(\gamma \nabla u) = f.\]</div>
</p>
<p>This equation characterizes the behavior of the temperature inside the domain <span class="math notranslate nohighlight">\(\Omega\)</span>. It must be complemented with information about the behavior at the boundary of <span class="math notranslate nohighlight">\(\Omega\)</span>. Usually, <span class="math notranslate nohighlight">\(\partial \Omega\)</span> is decomposed into two disjoint open regions, as:
<div class="math notranslate nohighlight">
\[\partial \Omega = \overline{\Gamma_D} \cup \overline{\Gamma_N}, \quad \Gamma_D \cap \Gamma_N = \emptyset.\]</div>

Here,</p>
<blockquote>
<div><ul class="simple">
<li><p>The temperature <span class="math notranslate nohighlight">\(u\)</span> is kept at a fixed value <span class="math notranslate nohighlight">\(u_0\)</span> on <span class="math notranslate nohighlight">\(\Gamma_D\)</span>;</p></li>
<li><p>A heat flux <span class="math notranslate nohighlight">\(g: \Gamma_N \to \R\)</span> is injected via the region <span class="math notranslate nohighlight">\(\Gamma_N\)</span>.</p></li>
</ul>
</div></blockquote>
<p>The first condition reads:</p>
<p><div class="math notranslate nohighlight">
\[u = u_0 \text{ on } \Gamma_D. \]</div>
</p>
<p>As for the second condition, equilibrium between the injected heat flux <span class="math notranslate nohighlight">\(g\)</span> and the heat induced by the temperature within the medium reads:</p>
<p><div class="math notranslate nohighlight">
\[-\bj \cdot \n + g=0, \text{ that is } \gamma \frac{\partial u}{\partial n} = -g. \]</div>
</p>
<p>Eventually, gathering all these informations yields the usual form of the Laplace equation:</p>
<div class="math notranslate nohighlight" id="equation-eq-conduc">
<span class="eqno">(1.21)<a class="headerlink" href="#equation-eq-conduc" title="Link to this equation">¶</a></span>\[\begin{split}\left\{ \begin{array}{cl}
- \dv(\gamma \nabla u) = f &amp; \text{in } \Omega, \\
u = u_0 &amp; \text{on } \Gamma_D,\\
\gamma \frac{\partial u}{\partial n} = -g &amp; \text{on } \Gamma_N.\\
\end{array}\right.\end{split}\]</div>
</section>
<section id="getting-started-with-texttt-freefem-resolution-of-the-laplace-equation">
<span id="sec-laplacestart"></span><h2><span class="section-number">1.4.2. </span>Getting started with <span class="math notranslate nohighlight">\(\texttt{FreeFem}\)</span>: resolution of the Laplace equation<a class="headerlink" href="#getting-started-with-texttt-freefem-resolution-of-the-laplace-equation" title="Link to this heading">¶</a></h2>
<p>For simplicity, we first consider a simplified version of the conductivity equation <a class="reference internal" href="#equation-eq-conduc">(1.21)</a>. Let <span class="math notranslate nohighlight">\(\Omega\)</span> be the <span class="math notranslate nohighlight">\(2d\)</span> L-shaped domain represented on <a class="reference internal" href="#fig-lshapelap"><span class="std std-numref">Fig. 1.8</span></a> (left); we search for the function <span class="math notranslate nohighlight">\(u : \Omega \to \R\)</span> characterized by:</p>
<div class="math notranslate nohighlight" id="equation-eq-laplace">
<span class="eqno">(1.22)<a class="headerlink" href="#equation-eq-laplace" title="Link to this equation">¶</a></span>\[\begin{split}\left\{ \begin{array}{cl}
- \Delta u = f &amp; \text{in } \Omega, \\
u = 0 &amp; \text{on } \partial \Omega,
\end{array}
\right.\end{split}\]</div>
<p>where the right-hand side equals <span class="math notranslate nohighlight">\(f=1\)</span>. The variational problem attached to this equation has been introduced in <a class="reference internal" href="varpbs.html#sec-lm"><span class="std std-numref">Section 1.2</span></a>:</p>
<div class="math notranslate nohighlight" id="equation-eq-laplacevf">
<span class="eqno">(1.23)<a class="headerlink" href="#equation-eq-laplacevf" title="Link to this equation">¶</a></span>\[\text{Search for } u \in H^1_0(\Omega)  \text{ s.t. } \forall v \in H^1_0(\Omega), \quad \int_\Omega \nabla u \cdot \nabla v \:\d \x = \int_\Omega fv \:\d \x,\]</div>
<p>where <span class="math notranslate nohighlight">\(H^1_0(\Omega)\)</span> is the Sobolev space of functions having one weak derivative in <span class="math notranslate nohighlight">\(L^2(\Omega)\)</span>, and vanishing on <span class="math notranslate nohighlight">\(\partial \Omega\)</span> (see <a class="reference internal" href="anafunc.html#sec-sobolev"><span class="std std-numref">Section 1.1.3.2</span></a>).</p>
<figure class="align-default" id="id2">
<span id="fig-lshapelap"></span><a class="reference internal image-reference" href="../_images/LshapeLap.png"><img alt="../_images/LshapeLap.png" src="../_images/LshapeLap.png" style="width: 969.0px; height: 322.0px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1.8 </span><span class="caption-text">(Left) The L-shaped domain <span class="math notranslate nohighlight">\(\Omega\)</span>; (middle) A triangular mesh of <span class="math notranslate nohighlight">\(\Omega\)</span>; (right) Values of the solution <span class="math notranslate nohighlight">\(u\)</span> to the Laplace equation <a class="reference internal" href="#equation-eq-laplace">(1.22)</a>.</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Let us now jump to the numerical resolution of this problem; the <span class="math notranslate nohighlight">\(\texttt{FreeFem}\)</span> source code can be downloaded <a class="reference download internal" download="" href="../_downloads/b551ba6e26ac96aa201bc8e32f88acbd/laplace_start.edp"><code class="xref download docutils literal notranslate"><span class="pre">here</span></code></a>, and we describe its contents.</p>
<p>As we have seen in the previous <a class="reference internal" href="FEtheory.html#sec-fe"><span class="std std-numref">Section 1.3</span></a>, the resolution of <a class="reference internal" href="#equation-eq-laplace">(1.22)</a> hinges on a mesh <span class="math notranslate nohighlight">\({\mathcal T}_h\)</span> of <span class="math notranslate nohighlight">\(\Omega\)</span>.
In <span class="math notranslate nohighlight">\(\texttt{FreeFem}\)</span>, this task is usually realized from the input of a collection of parametrized curves (oriented counterclockwise) defining the boundary <span class="math notranslate nohighlight">\(\partial \Omega\)</span> via the keyword <span class="math notranslate nohighlight">\(\texttt{border}\)</span>. The mesh <span class="math notranslate nohighlight">\({\mathcal T}_h\)</span> of the enclosed domain <span class="math notranslate nohighlight">\(\Omega\)</span> is then constructed thanks to the operator <span class="math notranslate nohighlight">\(\texttt{buildmesh}\)</span>, which allows to specify the desired number of nodes on each part of the boundary. These operations are detailed in the listing below.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Declaration of the boundary curves of the domain */</span>
<span class="kt">border</span><span class="w"> </span><span class="nf">left</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">){</span><span class="w"> </span><span class="kr">x</span><span class="o">=</span><span class="mf">0.0</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">1.0</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="kt">border</span><span class="w"> </span><span class="nf">bot</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">){</span><span class="w"> </span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="kt">border</span><span class="w"> </span><span class="nf">right</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">){</span><span class="w"> </span><span class="kr">x</span><span class="o">=</span><span class="mf">1.0</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="kt">border</span><span class="w"> </span><span class="nf">ang1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">){</span><span class="w"> </span><span class="kr">x</span><span class="o">=</span><span class="mf">1.0</span><span class="o">-</span><span class="kp">t</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="kt">border</span><span class="w"> </span><span class="nf">ang2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">){</span><span class="w"> </span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">0.5</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="kt">border</span><span class="w"> </span><span class="nf">top</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">){</span><span class="w"> </span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="o">-</span><span class="kp">t</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">1.0</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>

<span class="cm">/* Build mesh, display and save as a .mesh file */</span>
<span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">left</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="n">bot</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="n">right</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="n">ang1</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="n">ang2</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="n">top</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="nf">savemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="s">&quot;Lshape.mesh&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Once this is done, the Finite Element space <span class="math notranslate nohighlight">\(V_h\)</span> for the numerical solution <span class="math notranslate nohighlight">\(u_h\)</span> and test functions <span class="math notranslate nohighlight">\(v_h\)</span> is defined thanks to the keyword <span class="math notranslate nohighlight">\(\texttt{fespace}\)</span>, as exemplified below.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Definition of finite element spaces and functions */</span>
<span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="nc">P1</span><span class="p">);</span><span class="w"> </span><span class="c1">// or P2</span>
<span class="n">Vh</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">;</span><span class="w"> </span><span class="c1">// u,v are declared as elements in Vh</span>
</pre></div>
</div>
<p>Then, the right-hand side <span class="math notranslate nohighlight">\(f=1\)</span> is defined as a real-valued function; the <span class="math notranslate nohighlight">\(\texttt{FreeFem++}\)</span> syntax for this operation follows.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Source term; the undisplayed arguments are the spatial coordinates */</span>
<span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">f</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="p">(</span><span class="mf">1.0</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Finally, the variational formulation <a class="reference internal" href="#equation-eq-laplacevf">(1.23)</a> is entered:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Stationary heat equation (solver = Conjugate Gradient) */</span>
<span class="kt">problem</span><span class="w"> </span><span class="nf">laplace</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<span class="w">                               </span><span class="o">-</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">f</span><span class="p">()</span><span class="o">*</span><span class="n">v</span><span class="p">)</span>
<span class="w">                               </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">u</span><span class="o">=</span><span class="mf">0.0</span><span class="p">);</span><span class="w">  </span><span class="c1">// Homogeneous Dirichlet B.C.</span>

<span class="cm">/* Resolution of the problem */</span>
<span class="n">laplace</span><span class="p">;</span>

<span class="cm">/* Display and save the result */</span>
<span class="nf">savemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="s">&quot;Lshape.mesh&quot;</span><span class="p">);</span>
<span class="nf">savesol</span><span class="p">(</span><span class="s">&quot;Lshape.sol&quot;</span><span class="p">,</span><span class="n">Th</span><span class="p">,</span><span class="n">u</span><span class="p">);</span>
</pre></div>
</div>
<p>A comment is in order about the way homogeneous boundary conditions are supplied in <span class="math notranslate nohighlight">\(\texttt{FreeFem}\)</span>.
Contrary to the theoretical framework detailed in <a class="reference internal" href="varpbs.html#sec-bvptovarf"><span class="std std-numref">Section 1.2.1</span></a>, these are not comprised in the definition of the Finite Element space <span class="math notranslate nohighlight">\(V_h\)</span>.
Rather, the operator <span class="math notranslate nohighlight">\(\texttt{on}\)</span> is used to impose Dirichlet boundary conditions on the part of <span class="math notranslate nohighlight">\(\partial \Omega\)</span> identified with the label <span class="math notranslate nohighlight">\(1\)</span> (in the present
case, this represents the whole boundary <span class="math notranslate nohighlight">\(\partial\Omega\)</span>).
We shall see in <a class="reference internal" href="dirpen.html#sec-dirtgv"><span class="std std-numref">Section 1.8</span></a> how this operation is implemented.</p>
<div class="proof remark admonition" id="remark-0">
<p class="admonition-title"><span class="caption-number">Remark 1.7 </span></p>
<section class="remark-content" id="proof-content">
<p>The above listings exemplify two different means visualize the result of a numerical simulation such as that described just above, i.e. the values of the solution <span class="math notranslate nohighlight">\(\texttt{u}\)</span> at the vertices of the mesh <span class="math notranslate nohighlight">\(\texttt{Th}\)</span>:</p>
<ol class="arabic simple">
<li><p>Use the <span class="math notranslate nohighlight">\(\texttt{plot}\)</span> command in <span class="math notranslate nohighlight">\(\texttt{FreeFem}\)</span>;</p></li>
<li><p>Save the mesh <span class="math notranslate nohighlight">\(\texttt{Th}\)</span> and the solution <span class="math notranslate nohighlight">\(\texttt{u}\)</span> via to the <span class="math notranslate nohighlight">\(\texttt{savemesh}\)</span> and <span class="math notranslate nohighlight">\(\texttt{savesol}\)</span> commands, and use the software <span class="math notranslate nohighlight">\(\texttt{medit}\)</span>.</p></li>
</ol>
<p>More details about visualization are provided in <a class="reference internal" href="visualization.html#sec-visu"><span class="std std-numref">Section 1.5</span></a>, including in-depth explanations of <span class="math notranslate nohighlight">\(\texttt{medit}\)</span>.</p>
</section>
</div><div class="admonition-exo admonition">
<p class="admonition-title">Exercise</p>
<p>By adapting the above listings,</p>
<ol class="arabic">
<li><p>Solve the equation <a class="reference internal" href="#equation-eq-laplace">(1.22)</a> by using <span class="math notranslate nohighlight">\(\mathbb{P}_0\)</span>, or <span class="math notranslate nohighlight">\(\mathbb{P}_2\)</span> finite elements.</p></li>
<li><p>Change the mesh size in the discretization of <span class="math notranslate nohighlight">\(\Omega\)</span>.</p></li>
<li><p>Trade the right-hand side function <span class="math notranslate nohighlight">\(f=1\)</span> for a different, analytical one; for instance you may try:</p>
<p><div class="math notranslate nohighlight">
\[f(x_1,x_2) = x_2, \text{ or } f(x_1,x_2) = x_1^2\cos(x_2).\]</div>
</p>
</li>
<li><p>Solve the equation <a class="reference internal" href="#equation-eq-laplace">(1.22)</a> on different domains <span class="math notranslate nohighlight">\(\Omega\)</span> from the proposed L-shaped one (e.g. a disk, a rectangle, etc.).</p></li>
</ol>
</div>
</section>
<section id="changing-boundary-conditions-and-considering-inhomogeneous-coefficients">
<h2><span class="section-number">1.4.3. </span>Changing boundary conditions and considering inhomogeneous coefficients<a class="headerlink" href="#changing-boundary-conditions-and-considering-inhomogeneous-coefficients" title="Link to this heading">¶</a></h2>
<p>In this section, the physical domain of interest <span class="math notranslate nohighlight">\(\Omega\)</span> is again the L-shaped domain <span class="math notranslate nohighlight">\(\Omega\)</span> depicted in <a class="reference internal" href="#fig-lshapelapmixed"><span class="std std-numref">Fig. 1.9</span></a> (left). We now consider a version of the Laplace equation <a class="reference internal" href="#equation-eq-laplace">(1.22)</a> featuring an inhomogeneous conductivity coefficient <span class="math notranslate nohighlight">\(\gamma : \Omega \to \R\)</span> and mixed boundary conditions: as illustrated in <a class="reference internal" href="#fig-lshapelapmixed"><span class="std std-numref">Fig. 1.9</span></a> (left), the boundary <span class="math notranslate nohighlight">\(\partial \Omega\)</span> is now divided into two parts <span class="math notranslate nohighlight">\(\Gamma_D\)</span>, <span class="math notranslate nohighlight">\(\Gamma_N\)</span>, supporting respectively homogeneous Dirichlet, and inhomogeneous Neumann boundary conditions:</p>
<div class="math notranslate nohighlight" id="equation-eq-laplacemixed">
<span class="eqno">(1.24)<a class="headerlink" href="#equation-eq-laplacemixed" title="Link to this equation">¶</a></span>\[\begin{split}\left\{\begin{array}{cl}
-\dv(\gamma(\x) \nabla u )  = f &amp; \text{in } \Omega, \\
u = 0 &amp; \text{on } \Gamma_D, \\
\gamma \frac{\partial u}{\partial n} = g &amp; \text{on } \Gamma_N,
\end{array}\right.
\text{ with the conductivity } \gamma(\x) := \left\{
\begin{array}{cl}
1 &amp; \text{if } x_2 \geq \frac{1}{2}, \\
0.2 &amp; \text{if } x_1 &gt;= \frac{1}{2}, \\
0.5 &amp; \text{otherwise},
\end{array}
\right.\end{split}\]</div>
<p>and where the source and boundary flux equal respectively <span class="math notranslate nohighlight">\(f = 1\)</span> and <span class="math notranslate nohighlight">\(g=1\)</span>.</p>
<div class="admonition-exo admonition">
<p class="admonition-title">Exercise</p>
<ol class="arabic">
<li><p>Write down the variational formulation associated to <a class="reference internal" href="#equation-eq-laplacemixed">(1.24)</a>.</p></li>
<li><p>Implement the numerical resolution of this problem in <span class="math notranslate nohighlight">\(\texttt{FreeFem}\)</span>.</p>
<p><em>(Hint: To achieve this, you may get inspired by the syntax in the listing below to encode a boundary integral over a region of <span class="math notranslate nohighlight">\(\partial \Omega\)</span> in <span class="math notranslate nohighlight">\(\texttt{FreeFem}\)</span>.)</em></p>
</li>
<li><p>Consider again the above questions after replacing the Neumann boundary condition with the following Robin boundary condition:</p>
<p><div class="math notranslate nohighlight">
\[\gamma \frac{\partial u}{\partial n} + \alpha u = 0, \text{ where } \alpha &gt;0 \text{ is a fixed real number}.\]</div>
</p>
</li>
</ol>
</div>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Laplace equation with mixed b.c. (solver = Conjugate Gradient) */</span>
<span class="kt">problem</span><span class="w"> </span><span class="n">laplace</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">gamma</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>
<span class="w">                                </span><span class="o">-</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">f</span><span class="p">()</span><span class="o">*</span><span class="n">v</span><span class="p">)</span>
<span class="w">                                </span><span class="o">-</span><span class="w"> </span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="mi">2</span><span class="p">)(</span><span class="n">g</span><span class="p">()</span><span class="o">*</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="c1">// Integral of $g v$ over the region of the boundary of $Th$ labelled by 2</span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">u</span><span class="o">=</span><span class="mf">0.0</span><span class="p">);</span>
</pre></div>
</div>
<p>The solution <span class="math notranslate nohighlight">\(u\)</span> to this mixed boundary-value problem is depicted on <a class="reference internal" href="#fig-lshapelapmixed"><span class="std std-numref">Fig. 1.9</span></a> (right).</p>
<figure class="align-default" id="id3">
<span id="fig-lshapelapmixed"></span><a class="reference internal image-reference" href="../_images/LaplaceMixed.png"><img alt="../_images/LaplaceMixed.png" src="../_images/LaplaceMixed.png" style="width: 816.0px; height: 338.0px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1.9 </span><span class="caption-text">(Left) Setting of the mixed boundary value problem of <a class="reference internal" href="#equation-eq-laplacemixed">(1.24)</a>; (right) Plot of the solution <span class="math notranslate nohighlight">\(u\)</span>.</span><a class="headerlink" href="#id3" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="the-unsteady-laplace-equation">
<span id="sec-laplaceunsteady"></span><h2><span class="section-number">1.4.4. </span>The unsteady Laplace equation<a class="headerlink" href="#the-unsteady-laplace-equation" title="Link to this heading">¶</a></h2>
<p>In this section, we turn to a time-dependent version of the Laplace equation <a class="reference internal" href="#equation-eq-laplace">(1.22)</a>, posed over the 2d physical domain <span class="math notranslate nohighlight">\(\Omega=[0,2]\times [0,1]\)</span> and the time interval <span class="math notranslate nohighlight">\([0,T]\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-laplaceunsteady">
<span class="eqno">(1.25)<a class="headerlink" href="#equation-eq-laplaceunsteady" title="Link to this equation">¶</a></span>\[\begin{split}\left\{
\begin{array}{cl}
\frac{\partial u}{\partial t}- \Delta u = f &amp; \text{for } t \in (0,T), \:\: \x \in \Omega, \\
u(t,\x) = 0 &amp; \text{for } t\in (0,T), \:\: \x \in \partial \Omega,\\
u(0,\x) = u_0(\x) &amp; \text{for } \x \in \Omega.
\end{array}
\right.\end{split}\]</div>
<p>Here,</p>
<blockquote>
<div><ul class="simple">
<li><p>The initial data <span class="math notranslate nohighlight">\(u_0\)</span> is supported in two disjoint disks, where it takes two distinct values, see <a class="reference internal" href="#fig-laplaceunsteady"><span class="std std-numref">Fig. 1.10</span></a> (top,right).</p></li>
<li><p>the source (or sink) <span class="math notranslate nohighlight">\(f\)</span> equals <span class="math notranslate nohighlight">\(-1\)</span>,</p></li>
</ul>
</div></blockquote>
<p>We do not discuss the rather technical formalism for such time evolution problems, and we describe its solution in a formal manner.</p>
<p>This problem has to be discretized in both time and space. Essentially, for the time discretization, we use a Finite Difference time-stepping scheme, and for the spatial discretization, we use the Finite Element method.</p>
<p>Let us proceed step by step, and first derive a suitable variational formulation for <a class="reference internal" href="#equation-eq-laplaceunsteady">(1.25)</a>: we multiply both sides of the main equation by a test function <span class="math notranslate nohighlight">\(v\)</span> which only depends on the spatial variable <span class="math notranslate nohighlight">\(\x\)</span>. This yields, for each time <span class="math notranslate nohighlight">\(t \in (0,T)\)</span>:</p>
<p><div class="math notranslate nohighlight">
\[\int_\Omega \frac{\partial u}{\partial t}(t,\x) v(\x) \:\d \x - \int_\Omega \Delta u(t,\x) v(\x) \:\d\x = \int_\Omega f(\x) v(\x)\:\d\x.\]</div>
</p>
<p>Now, using that <span class="math notranslate nohighlight">\(v\)</span> is independent of time, we can take the time derivative out of the first integral in the above left-hand side; doing so and integration by parts with <a class="reference internal" href="anafunc.html#sec-green"><span class="std std-ref">Green’s’ formula</span></a> in the second integral, we obtain:</p>
<p><div class="math notranslate nohighlight">
\[\frac{\d}{\d t}\left(\int_\Omega u(t,\x) v(\x) \:\d \x \right) + \int_\Omega \nabla u(t,\x) \cdot \nabla v(t,\x) \:\d\x = \int_\Omega f(\x) v(t,\x)\:\d\x.\]</div>
</p>
<p>Let us now set:</p>
<p><div class="math notranslate nohighlight">
\[V= H^1_0(\Omega), \text{ and for all } u,v \in V, \quad m(u,v) = \int_\Omega uv \:\d \x, \:\:\: a(u,v) = \int_\Omega \nabla u \cdot \nabla v \:\d \x, \text{ and } \ell(v) = \int_\Omega fv\:\d\x. \]</div>
</p>
<p>As usual, the choice of the functional space <span class="math notranslate nohighlight">\(V = H^1_0(\Omega)\)</span> is dictated by the homogeneous Dirichlet boundary condition in <a class="reference internal" href="#equation-eq-laplaceunsteady">(1.25)</a>. With these notations, we arrive at the continuous in time and space variational formulation for <a class="reference internal" href="#equation-eq-laplaceunsteady">(1.25)</a>:</p>
<p><div class="math notranslate nohighlight">
\[\text{Search for } u(t,\cdot) \in V, \text{ s.t. forall } v \in V, \quad \frac{\d}{\d t} m(u(t,\cdot),v) + a(u,v) = \ell(v). \]</div>
</p>
<p>We now perform time discretization: introducing a time step <span class="math notranslate nohighlight">\(\Delta t\)</span>, we let <span class="math notranslate nohighlight">\(t^n = n \Delta t\)</span>, <span class="math notranslate nohighlight">\(n=0,\ldots\)</span>; we also denote by <span class="math notranslate nohighlight">\(u^n(\x) = u(t^n,\x)\)</span> the space-dependent function <span class="math notranslate nohighlight">\(u\)</span> at the particular time <span class="math notranslate nohighlight">\(t^n\)</span>. Using an implicit discretization of the time derivative in the above formulation, we are led to search for the collection <span class="math notranslate nohighlight">\(\left\{u^n \right\}_{n=0,\ldots,N}\)</span> of functions in <span class="math notranslate nohighlight">\(V\)</span> defined by:</p>
<p><div class="math notranslate nohighlight">
\[\begin{split}\left\{
\begin{array}{l}
u^0 \text{ is the initial datum } u_0, \\
\text{For all } n=0,\ldots,N-1, \:\: u^{n+1} \in V \text{ is characterized by: } \:\: \forall \: v \in V, \quad \frac{m(u^{n+1},v) - m(u^n,v)}{\Delta t} + a(u^{n+1},v) = \ell(v).
\end{array}
\right.\end{split}\]</div>
</p>
<p>After rearranging these expressions, the solution of <a class="reference internal" href="#equation-eq-laplaceunsteady">(1.25)</a> is realized as follows:</p>
<blockquote>
<div><ul>
<li><p><span class="math notranslate nohighlight">\(u^0\)</span> is the initial datum <span class="math notranslate nohighlight">\(u_0\)</span>;</p></li>
<li><p>For <span class="math notranslate nohighlight">\(n=0,...,N-1\)</span>, calculate <span class="math notranslate nohighlight">\(u^{n+1}\)</span> from <span class="math notranslate nohighlight">\(u^n\)</span> by solving the variational problem:</p>
<div class="math notranslate nohighlight" id="equation-eq-varflaplaceunsteady">
<span class="eqno">(1.26)<a class="headerlink" href="#equation-eq-varflaplaceunsteady" title="Link to this equation">¶</a></span>\[\text{Search for } u^{n+1} \in V, \text{ s.t. for all } v \in V, \quad m(u^{n+1},v) + \Delta t \: a(u^{n+1},v) = m(u^n,v) + \Delta t \:\ell(v).\]</div>
</li>
</ul>
</div></blockquote>
<p>The implementation of this scheme in <span class="math notranslate nohighlight">\(\texttt{FreeFem}\)</span> is barely more complicated than the resolution of the steady Laplace equation tackled in <a class="reference internal" href="#sec-laplacestart"><span class="std std-numref">Section 1.4.2</span></a>. The only additional ingredient is the use of a <span class="math notranslate nohighlight">\(\texttt{for}\)</span> loop over the time index <span class="math notranslate nohighlight">\(n=0,\ldots,N\)</span>, along the lines of the following listing:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Semi-discrete in time variational formulation of the heat equation */</span>
<span class="kt">problem</span><span class="w"> </span><span class="nf">sdheat</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="p">)</span>
<span class="w">                              </span><span class="o">+</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>
<span class="w">                              </span><span class="o">-</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">uo</span><span class="o">*</span><span class="n">v</span><span class="p">)</span>
<span class="w">                              </span><span class="o">-</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="n">refsink</span><span class="p">)(</span><span class="n">f</span><span class="p">()</span><span class="o">*</span><span class="n">v</span><span class="p">)</span>
<span class="w">                              </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>

<span class="cm">/* Main loop: at the beginning of each iteration, uo is the solution at step n,</span>
<span class="cm">  then the solution u at step (n+1) is calculated */</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">it</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="o">&lt;</span><span class="kp">maxit</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">sdheat</span><span class="p">;</span>
<span class="w">  </span><span class="n">uo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="proof remark admonition" id="remark-1">
<p class="admonition-title"><span class="caption-number">Remark 1.8 </span></p>
<section class="remark-content" id="proof-content">
<p>It is instructive to write the Finite Element discretization of the variational problem <a class="reference internal" href="#equation-eq-varflaplaceunsteady">(1.26)</a>. Like in <a class="reference internal" href="FEtheory.html#sec-fe"><span class="std std-numref">Section 1.3</span></a>, let <span class="math notranslate nohighlight">\(V_h\)</span> be the chosen Finite Element space for the discretization of <span class="math notranslate nohighlight">\(V\)</span>, so that the Finite Element problem reads:</p>
<p><div class="math notranslate nohighlight">
\[\text{Search for } u_h^{n+1} \in V_h, \text{ s.t. for all } v_h \in V_h, \quad m(u_h^{n+1},v_h) + \Delta t \: a(u_h^{n+1},v_h) = m(u_h^n,v_h) + \Delta t \:\ell(v_h).\]</div>
</p>
<p>Let now <span class="math notranslate nohighlight">\(\left\{\phi_i \right\}_{i=1,\ldots,N_{V_h}}\)</span> be a basis of <span class="math notranslate nohighlight">\(V_h\)</span>, and for each <span class="math notranslate nohighlight">\(n=0,\ldots,N\)</span>, let us denote by <span class="math notranslate nohighlight">\(\bU_h^n \in \R^{N_{V_h}}\)</span> the vector gathering the coordinates of <span class="math notranslate nohighlight">\(u_h^n\)</span> in this basis. We arrive at the following linear system with size <span class="math notranslate nohighlight">\(N_{V_h}\)</span>:</p>
<p><div class="math notranslate nohighlight">
\[(M_h  + \Delta t K_h) \bU_h^{n+1} = M \bU_h^{n} + \Delta t \bF_h.\]</div>
</p>
<p>Here,</p>
<blockquote>
<div><ul>
<li><p><span class="math notranslate nohighlight">\(K_h\)</span> is the <span class="math notranslate nohighlight">\(N_{V_h} \times N_{V_h}\)</span> stiffness matrix associated to the Laplace operator:</p>
<p><div class="math notranslate nohighlight">
\[(K_h)_{ij} = \int_\Omega \nabla \phi_i \cdot \nabla \phi_j \:\d x, \quad i,j=1,\ldots,N_{V_h}. \]</div>
</p>
</li>
<li><p><span class="math notranslate nohighlight">\(\bF_h \in \R^{N_{V_h}}\)</span> is the load vector defined by:</p>
<p><div class="math notranslate nohighlight">
\[(F_h)_{i} = \int_\Omega f \phi_i \:\d x, \quad i=1,\ldots,N_{V_h}. \]</div>
</p>
</li>
<li><p><span class="math notranslate nohighlight">\(M_h\)</span> is the <span class="math notranslate nohighlight">\(N_{V_h} \times N_{V_h}\)</span> mass matrix:</p>
<p><div class="math notranslate nohighlight">
\[(M_h)_{ij} = \int_\Omega  \phi_i  \phi_j \:\d x, \quad i,j=1,\ldots,N_{V_h}. \]</div>
</p>
</li>
</ul>
</div></blockquote>
</section>
</div><p>Click <a class="reference download internal" download="" href="../_downloads/0725e8707f8c9e41e0a797512c7aa28a/laplace_unsteady.edp"><code class="xref download docutils literal notranslate"><span class="pre">here</span></code></a> for the source code of this example; a few snapshots of the evolution process are depicted on <a class="reference internal" href="#fig-laplaceunsteady"><span class="std std-numref">Fig. 1.10</span></a>.</p>
<figure class="align-default" id="id4">
<span id="fig-laplaceunsteady"></span><a class="reference internal image-reference" href="../_images/LaplaceUnsteady.png"><img alt="../_images/LaplaceUnsteady.png" src="../_images/LaplaceUnsteady.png" style="width: 964.0px; height: 508.0px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1.10 </span><span class="caption-text">(Top, left) Setting of the unsteady laplace equation; (top,right) Initial distribution of temperature <span class="math notranslate nohighlight">\(u_0\)</span>; (bottom, left) Temperature <span class="math notranslate nohighlight">\(u\)</span> at time <span class="math notranslate nohighlight">\(t=0.1\)</span>; (bottom, right) Final distribution of <span class="math notranslate nohighlight">\(u\)</span>.</span><a class="headerlink" href="#id4" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/falcmill.png" alt="Logo" />
    
  </a>
</p>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index_gen.html">1. Generalities</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="anafunc.html">1.1. Functional analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="varpbs.html">1.2. Lax-Milgram framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="FEtheory.html">1.3. The Finite Element method</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.4. Laplace equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">1.5. Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="mesh.html">1.6. Meshes</a></li>
<li class="toctree-l2"><a class="reference internal" href="eigen.html">1.7. Eigenvalues</a></li>
<li class="toctree-l2"><a class="reference internal" href="dirpen.html">1.8. Penalization for Dirichlet conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="laplace_pure_Neumann.html">1.9. Pure Neumann</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Advanced/index_adv.html">2. Advanced features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Structure_Mechanics/index_structmech.html">3. Structure mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Fluid_Mechanics/index_fl.html">4. Fluid mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Optimal_design/index_od.html">5. Optimal design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Appendix/index_app.html">6. Appendix</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">7. Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">8. Glossary</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index_gen.html"><span class="section-number">1. </span>Getting started</a><ul>
      <li>Previous: <a href="FEtheory.html" title="previous chapter"><span class="section-number">1.3. </span>An introduction to the Finite Element method</a></li>
      <li>Next: <a href="visualization.html" title="next chapter"><span class="section-number">1.5. </span>Visualization of meshes and solutions</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;.
      
      |
      <a href="../_sources/Generalities/laplace.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>