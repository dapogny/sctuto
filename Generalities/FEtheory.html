<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.3. An introduction to the Finite Element method &#8212; Numerical tours in scientific computing</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=8203d6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=25db1f2b" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gen.css?v=1d84c916" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>window.MathJax = {"tex": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "macros": {"calA": "{{\\mathcal A}}", "calC": "{{\\mathcal C}}", "calI": "{{\\mathcal I}}", "calF": "{{\\mathcal F}}", "calL": "{{\\mathcal L}}", "bz": "{\\mathbf{0}}", "d": "{\\text{d}}", "dv": "{\\text{div}}", "e": "{\\varepsilon}", "be": "{\\textbf{e}}", "n": "{\\textbf{n}}", "t": "{\\textbf{t}}", "f": "{\\textbf{f}}", "g": "{\\textbf{g}}", "u": "{\\textbf{u}}", "m": "{\\textbf{m}}", "v": "{\\textbf{v}}", "p": "{\\textbf{p}}", "bj": "{\\textbf{j}}", "bC": "{\\textbf{C}}", "bF": "{\\textbf{F}}", "bU": "{\\textbf{U}}", "bV": "{\\textbf{V}}", "x": "{\\textbf{x}}", "y": "{\\textbf{y}}", "bX": "{\\textbf{X}}", "P": "{\\mathbb{P}}", "R": "{\\mathbb{R}}", "N": "{\\mathbb{N}}", "I": "{\\text{I}}", "Id": "{\\text{Id}}", "o": "{\\text{o}}", "calT": "{{\\mathcal T}}", "Hdiv": "{H_{\\text{div}}}", "tr": "{\\text{tr}}", "bold": ["{\\bf #1}", 1]}, "loader": {"load": ["[tex]/boldsymbol"]}, "packages": {"[+]": ["boldsymbol"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1.4. The Laplace equation in all its forms" href="laplace.html" />
    <link rel="prev" title="1.2. The Lax-Milgram variational theory" href="varpbs.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="an-introduction-to-the-finite-element-method">
<span id="sec-fe"></span><h1><span class="section-number">1.3. </span>An introduction to the Finite Element method<a class="headerlink" href="#an-introduction-to-the-finite-element-method" title="Link to this heading">¶</a></h1>
<p>We now discuss the numerical resolution of a boundary value problem by means of the Finite Element method.
As we have mentioned, this method builds on the variational form of this problem, a notion which was introduced in the previous <a class="reference internal" href="varpbs.html#sec-lm"><span class="std std-numref">Section 1.2</span></a>. To better see the big picture, we consider the following generic variational problem:</p>
<div class="math notranslate nohighlight" id="equation-eq-varpbfe">
<span class="eqno">(1.14)<a class="headerlink" href="#equation-eq-varpbfe" title="Link to this equation">¶</a></span>\[\text{Search for } u \in V \text{ s.t. for all } v \in V, \quad a(u,v) = \ell(v),\]</div>
<p>where:</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(V\)</span> is a Hilbert space of functions <span class="math notranslate nohighlight">\(u : \Omega \to \R\)</span> defined on a spatial domain <span class="math notranslate nohighlight">\(\Omega \subset \R^d\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(a: V \times V \to \R\)</span> is a bilinear, continuous and coercive form on <span class="math notranslate nohighlight">\(V\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(\ell: V \to \R\)</span> is a continuous linear form on <span class="math notranslate nohighlight">\(V\)</span>.</p></li>
</ul>
</div></blockquote>
<p>We have seen in <a class="reference internal" href="varpbs.html#sec-lm"><span class="std std-numref">Section 1.2</span></a> that under these assumptions, <a class="reference internal" href="#equation-eq-varpbfe">(1.14)</a> is well-posed, i.e. it has a unique solution <span class="math notranslate nohighlight">\(u \in V\)</span> which depends continuously on the data <span class="math notranslate nohighlight">\(\ell\)</span>.</p>
<p>The Finite Element Method consists in searching for a solution <span class="math notranslate nohighlight">\(u\)</span> to this variational problem by restricting it to a finite-dimensional subspace <span class="math notranslate nohighlight">\(V_h\)</span> of <span class="math notranslate nohighlight">\(V\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-varpbfedisc">
<span class="eqno">(1.15)<a class="headerlink" href="#equation-eq-varpbfedisc" title="Link to this equation">¶</a></span>\[\text{Search for } u_h \in V_h \text{ s.t. for all } v_h \in V_h, \quad a(u_h,v_h) = \ell(v_h).\]</div>
<p>Here, the subscript <span class="math notranslate nohighlight">\(_h\)</span> refers to the accuracy of the method. As we shall see below, the discrete space <span class="math notranslate nohighlight">\(V_h\)</span> is constructed from a mesh of the physical domain <span class="math notranslate nohighlight">\(\Omega\)</span> and <span class="math notranslate nohighlight">\(h\)</span> typically refers to the &quot;size&quot; of this mesh. It is expected that, as <span class="math notranslate nohighlight">\(h\)</span> decreases, <span class="math notranslate nohighlight">\(u_h\)</span> is a more and more accurate approximation of <span class="math notranslate nohighlight">\(u\)</span>.</p>
<section id="a-short-digression-about-meshes">
<span id="sec-meshintrofe"></span><h2><span class="section-number">1.3.1. </span>A short digression about meshes<a class="headerlink" href="#a-short-digression-about-meshes" title="Link to this heading">¶</a></h2>
<p>The Finite Element Method builds on a mesh of the spatial domain <span class="math notranslate nohighlight">\(\Omega\)</span>.
Here, we provide a few ingredients about this notion, referring to the later <a class="reference internal" href="mesh.html#sec-mesh"><span class="std std-numref">Section 1.6</span></a> for practical details.
The readers eager to discover more about meshes may fruitfully consult the very comprehensive book <span id="id1">[<a class="reference internal" href="bibliography.html#id9" title="Pascal Jean Frey and Paul-Louis George. Mesh generation: application to finite elements. ISTE, 2007.">FG07</a>]</span>.
For simplicity, we focus this presentation on the 2d case, but all the material below extends to the 3d case.</p>
<p>Let us start with a definition, which is illustrated on <a class="reference internal" href="#fig-meshdefs"><span class="std std-numref">Fig. 1.3</span></a>.</p>
<div class="proof definition admonition" id="definition-0">
<span id="def-mesh"></span><p class="admonition-title"><span class="caption-number">Definition 1.5 </span></p>
<section class="definition-content" id="proof-content">
<p>A mesh <span class="math notranslate nohighlight">\(\calT\)</span> of <span class="math notranslate nohighlight">\(\Omega\)</span> is a subdivision of this domain into a number <span class="math notranslate nohighlight">\(N_{\calT}\)</span> of closed simplices (i.e. triangles in 2d, tetrahedra in 3d) <span class="math notranslate nohighlight">\(T_i\)</span>, <span class="math notranslate nohighlight">\(i=1,...,N_{\mathcal T}\)</span> with disjoint interiors <span class="math notranslate nohighlight">\(\mathring{T_i}\)</span>, <span class="math notranslate nohighlight">\(\mathring{T_j}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\overline{\Omega} = \bigcup\limits_{i=1}^{N_{\mathcal T}}{T_i}, \text{ where } \mathring{T_i} \cap \mathring{T_j} = \emptyset \text{ if } i \neq j.\]</div>
<p>Such a mesh is often required to be conforming: the intersection <span class="math notranslate nohighlight">\(T_i \cap T_j\)</span> between any two elements is either a vertex, or an edge, or a face of <span class="math notranslate nohighlight">\(T_i\)</span> and <span class="math notranslate nohighlight">\(T_j\)</span>.</p>
</section>
</div><figure class="align-default" id="id2">
<span id="fig-meshdefs"></span><a class="reference internal image-reference" href="../_images/4meshes.png"><img alt="../_images/4meshes.png" src="../_images/4meshes.png" style="width: 685.1999999999999px; height: 492.59999999999997px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1.3 </span><span class="caption-text">Various types of meshes: (a) An invalid mesh, with overlapping triangles (in red); (b) A non conforming mesh: the closures of the red triangles do not intersect along a whole common edge; (c) A valid and conforming, yet ill-shaped mesh (low-quality elements are represented in red); (d) A conforming mesh. In all cases, the external boundary of <span class="math notranslate nohighlight">\(\Omega\)</span> is represented in bold.</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<section id="size-of-a-mesh">
<h3><span class="section-number">1.3.1.1. </span>Size of a mesh<a class="headerlink" href="#size-of-a-mesh" title="Link to this heading">¶</a></h3>
<p>The size of a mesh is a crucial feature; we indeed expect the mesh <span class="math notranslate nohighlight">\({\mathcal T}\)</span> to be sufficiently fine, for at least two reasons:</p>
<ul class="simple">
<li><p>Geometric approximation: Often, the domain <span class="math notranslate nohighlight">\(\Omega\)</span> is not a polygon: it is a smooth domain which is approximated by the polygonal mesh <span class="math notranslate nohighlight">\(\calT\)</span>. It is thus natural to require that <span class="math notranslate nohighlight">\(\calT\)</span> be a fine geometric approximation of <span class="math notranslate nohighlight">\(\Omega\)</span>.</p></li>
<li><p>Computational approximation: As we shall see below, the accuracy of the numerical solution supplied by the finite element method is related to the size of the elements of <span class="math notranslate nohighlight">\(\calT\)</span>. Intuitively, if the continuous solution <span class="math notranslate nohighlight">\(u\)</span> has large variations in a region of the domain <span class="math notranslate nohighlight">\(\Omega\)</span>, the mesh <span class="math notranslate nohighlight">\(\calT\)</span> has to be fine enough (at least in this region) to authorize the capture of this phenomenon.</p></li>
</ul>
<p>For this reason, a common practice is to label the mesh <span class="math notranslate nohighlight">\(\calT\)</span> as <span class="math notranslate nohighlight">\({\mathcal T}_h\)</span>, where <span class="math notranslate nohighlight">\(h\)</span> is a measure of its &quot;size&quot;. For instance, <span class="math notranslate nohighlight">\(h\)</span> may represent the largest diameter of a triangle in the mesh:</p>
<p><div class="math notranslate nohighlight">
\[h = \sup\limits_{T \in \calT} \text{diam}(T), \text{ where } \text{diam}(T) = \sup\limits_{\x,\y\in T} \lvert \x - \y\lvert. \]</div>
</p>
</section>
<section id="quality-of-a-mesh">
<h3><span class="section-number">1.3.1.2. </span>Quality of a mesh<a class="headerlink" href="#quality-of-a-mesh" title="Link to this heading">¶</a></h3>
<p>One second notion of utter importance is the quality of the mesh <span class="math notranslate nohighlight">\(\calT\)</span>: multiple numerical operations conducted on <span class="math notranslate nohighlight">\(\calT\)</span> require that it be &quot;well-shaped&quot;, i.e. that each element <span class="math notranslate nohighlight">\(T \in \calT\)</span> be close to equilateral, and not degenerate. One possible &quot;quality factor&quot; to account for this feature is the following ratio:</p>
<p><div class="math notranslate nohighlight">
\[\frac{\text{diam}(T)}{\rho(T)}, \]</div>
</p>
<p>where the inradius <span class="math notranslate nohighlight">\(\rho(T)\)</span> of <span class="math notranslate nohighlight">\(T\)</span> is the radius of the largest ball contained in <span class="math notranslate nohighlight">\(T\)</span>, see <a class="reference internal" href="#fig-aspecttria"><span class="std std-numref">Fig. 1.4</span></a>.</p>
<figure class="align-default" id="id3">
<span id="fig-aspecttria"></span><a class="reference internal image-reference" href="../_images/aspecttria.png"><img alt="../_images/aspecttria.png" src="../_images/aspecttria.png" style="width: 336.0px; height: 159.0px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1.4 </span><span class="caption-text">Diameter <span class="math notranslate nohighlight">\(\text{diam}(T)\)</span> and inradius <span class="math notranslate nohighlight">\(\rho(T)\)</span> of a triangle.</span><a class="headerlink" href="#id3" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>In practice, slightly different error measures may be used, such as:</p>
<p><div class="math notranslate nohighlight">
\[{\mathcal Q}(T) = \alpha \frac{\text{Vol}(T)}{\sum\limits_{i=1}^3 \lvert \be_i \lvert^2},\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(\text{Vol}(T)\)</span> is the volume of <span class="math notranslate nohighlight">\(T\)</span>, and <span class="math notranslate nohighlight">\(\be_1,\be_2,\be_3\)</span> are its edges. <span class="math notranslate nohighlight">\(\alpha\)</span> is a suitable normalization constant.</p>
<p>In any event, a quality close to <span class="math notranslate nohighlight">\(0\)</span> should indicate a nearly degenerate triangle, while a quality near <span class="math notranslate nohighlight">\(1\)</span> should indicate a triangle close to equilateral. We refer to <a class="reference internal" href="#fig-meshcal"><span class="std std-numref">Fig. 1.5</span></a> for an illustration and <a class="reference internal" href="#sec-fecv"><span class="std std-numref">Section 1.3.4</span></a> about the importance of this feature to guarantee the accuracy of the Finite Element Method.</p>
<div class="proof remark admonition" id="remark-1">
<p class="admonition-title"><span class="caption-number">Remark 1.4 </span></p>
<section class="remark-content" id="proof-content">
<p>This notion of &quot;Finite Element quality&quot; for a mesh <span class="math notranslate nohighlight">\(\calT\)</span> is often complemented with a notion of &quot;geometric quality&quot;, appraising how well the discrete polygon <span class="math notranslate nohighlight">\(\calT\)</span> approximates the continuous domain <span class="math notranslate nohighlight">\(\Omega\)</span> under scrutiny.</p>
</section>
</div><figure class="align-default" id="id4">
<span id="fig-meshcal"></span><a class="reference internal image-reference" href="../_images/meshcal.png"><img alt="../_images/meshcal.png" src="../_images/meshcal.png" style="width: 969.0px; height: 471.59999999999997px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1.5 </span><span class="caption-text">(Left) Valid and conforming mesh, containing low-quality elements (in red), and representing a poor geometric approximation (in blue) (right) High-quality mesh of the same domain.</span><a class="headerlink" href="#id4" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="finite-element-spaces">
<h2><span class="section-number">1.3.2. </span>Finite Element spaces<a class="headerlink" href="#finite-element-spaces" title="Link to this heading">¶</a></h2>
<p>Let us return to our purpose of constructing a suitable Finite Element space <span class="math notranslate nohighlight">\(V_h \subset V\)</span> to formulate the discrete counterpart <a class="reference internal" href="#equation-eq-varpbfedisc">(1.15)</a> of the variational problem <a class="reference internal" href="#equation-eq-varpbfe">(1.14)</a>. The datum of a mesh <span class="math notranslate nohighlight">\(\calT_h\)</span> of <span class="math notranslate nohighlight">\(\Omega\)</span> paves the way to several ways of achieving this purpose:</p>
<blockquote>
<div><ul>
<li><p>The space <span class="math notranslate nohighlight">\(V(\calT_h,\P_0)\)</span> of <span class="math notranslate nohighlight">\(\P_0\)</span> Lagrange Finite Element functions is composed of the functions <span class="math notranslate nohighlight">\(u:\Omega \to \R\)</span> which are constant inside each simplex <span class="math notranslate nohighlight">\(T \in \calT_h\)</span>:</p>
<p><div class="math notranslate nohighlight">
\[V(\calT_h,\P_0) = \left\{u \in L^2(\Omega), \:\: \ \forall T \in \calT_h, \:\: u\lvert_T \in \P_0 \right\},\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(\P_0\)</span> is the vector space of <span class="math notranslate nohighlight">\(0^{\text{th}}\)</span>-order polynomial functions (i.e. constants) in <span class="math notranslate nohighlight">\(d\)</span> variables.</p>
</li>
<li><p>The space <span class="math notranslate nohighlight">\(V(\calT_h,\P_1)\)</span> of <span class="math notranslate nohighlight">\(\P_1\)</span> Lagrange Finite Element functions consists of the functions which are continuous on <span class="math notranslate nohighlight">\(\Omega\)</span>, and whose restriction to each triangle <span class="math notranslate nohighlight">\(T \in \calT_h\)</span> belongs to the space <span class="math notranslate nohighlight">\(\P_1\)</span> of first-order polynomial functions (i.e. affine functions) in <span class="math notranslate nohighlight">\(d\)</span> variables:</p></li>
</ul>
<p><div class="math notranslate nohighlight">
\[V(\calT_h,\P_1) = \left\{u \in \calC(\overline\Omega), \:\: \ \forall T \in \calT_h, \:\: u\lvert_T \in \P_1 \right\}.\]</div>
</p>
<ul class="simple">
<li><p>More generally, for <span class="math notranslate nohighlight">\(k \geq 1\)</span>, the space <span class="math notranslate nohighlight">\(V(\calT_h,\P_k)\)</span> of <span class="math notranslate nohighlight">\(\P_k\)</span> Lagrange Finite Element functions consists of the functions which are continuous on <span class="math notranslate nohighlight">\(\Omega\)</span>, and whose restriction to each triangle <span class="math notranslate nohighlight">\(T \in \calT_h\)</span> belongs to the space <span class="math notranslate nohighlight">\(\P_k\)</span> of polynomial functions in <span class="math notranslate nohighlight">\(d\)</span> variables, whose order is less or equals to <span class="math notranslate nohighlight">\(k\)</span>:</p></li>
</ul>
<p><div class="math notranslate nohighlight">
\[V(\calT_h,\P_k) = \left\{u \in \calC(\overline\Omega), \:\: \ \forall T \in \calT_h, \:\: u\lvert_T \in \P_k \right\}.\]</div>
</p>
<ul class="simple">
<li><p>Other, slightly more exotic Finite Element spaces can be considered, such as:</p>
<ul>
<li><p>The Taylor-Hood Finite Element space for discretizing the (vector-valued) velocity and pressure of a fluid;</p></li>
<li><p>The Nédélec and Raviart-Thomas Finite Element spaces which are commonly used in electromagnetism owing to their good behavior with respect to the divergence and curl operators.</p></li>
</ul>
</li>
</ul>
</div></blockquote>
<p>In practice, the discrete space <span class="math notranslate nohighlight">\(V_h\)</span> is equipped with a basis <span class="math notranslate nohighlight">\(\left\{ \phi_i\right\}_{i=1,...,N_{V_h}}\)</span>; for instance:</p>
<blockquote>
<div><ul class="simple">
<li><p>The space <span class="math notranslate nohighlight">\(V(\calT_h,\P_0)\)</span> has a dimension <span class="math notranslate nohighlight">\(N_{V_h} = N_{\calT_h}\)</span> equal to the number <span class="math notranslate nohighlight">\(N_{V_h}\)</span> of elements (i.e. triangles in 2d, tetrahedra in 3d) in the mesh. For every <span class="math notranslate nohighlight">\(i=1,...,N_{V_h}\)</span>, the basis function <span class="math notranslate nohighlight">\(\phi_i\)</span> associated to the simplex <span class="math notranslate nohighlight">\(T_i\)</span> reads:</p></li>
</ul>
<p><div class="math notranslate nohighlight">
\[\begin{split}\phi_i(\x) = \left\{
\begin{array}{cl}
1 &amp; \text{if } \x \in T_i ,\\
0 &amp; \text{otherwise,}
\end{array}
\right. \end{split}\]</div>
</p>
<blockquote>
<div><p>see <a class="reference internal" href="#fefuncs"><span class="std std-numref">Fig. 1.6</span></a> (left).</p>
</div></blockquote>
<ul class="simple">
<li><p>The dimension <span class="math notranslate nohighlight">\(N_{V_h}\)</span> of the space <span class="math notranslate nohighlight">\(V(\calT_h,\P_1)\)</span> equals the number of vertices <span class="math notranslate nohighlight">\(\p_1,\ldots,\p_{N_{V_h}}\)</span> in the mesh <span class="math notranslate nohighlight">\(\calT_h\)</span>. For every <span class="math notranslate nohighlight">\(i=1,...,N_{V_h}\)</span>, the basis function <span class="math notranslate nohighlight">\(\phi_i\)</span> associated to the vertex <span class="math notranslate nohighlight">\(\p_i\)</span> of the mesh is the &quot;hat function&quot; characterized by:</p></li>
</ul>
<p><div class="math notranslate nohighlight">
\[\begin{split}\left\{
\begin{array}{l}
\phi_i(\p_i) = 1\\
\phi_i(\p_j) = 0 \text{ if } j \neq i, \\
\phi_i \text{ is affine inside each element } T \in \calT_h,
\end{array}
\right.\end{split}\]</div>
</p>
<blockquote>
<div><p>see <a class="reference internal" href="#fefuncs"><span class="std std-numref">Fig. 1.6</span></a> (right).</p>
</div></blockquote>
</div></blockquote>
<p>Any Finite Element function <span class="math notranslate nohighlight">\(u_h \in V_h\)</span> may be decomposed on this basis:</p>
<div class="math notranslate nohighlight" id="equation-eq-decompfebasis">
<span class="eqno">(1.16)<a class="headerlink" href="#equation-eq-decompfebasis" title="Link to this equation">¶</a></span>\[u_h = \sum\limits_{i=1}^{N_{V_h}}{u_i \phi_i},\]</div>
<p>where the coefficients <span class="math notranslate nohighlight">\(u_i\)</span> are referred to as the degrees of freedom of the Finite Element Method.</p>
<figure class="align-default" id="id5">
<span id="fefuncs"></span><a class="reference internal image-reference" href="../_images/FEfuncs.png"><img alt="../_images/FEfuncs.png" src="../_images/FEfuncs.png" style="width: 863.0px; height: 231.0px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1.6 </span><span class="caption-text">(Left) Graph of the <span class="math notranslate nohighlight">\(\P_0\)</span> basis function which equals <span class="math notranslate nohighlight">\(1\)</span> on the dashed triangle and <span class="math notranslate nohighlight">\(0\)</span> elsewhere; (right) Graph of the <span class="math notranslate nohighlight">\(\P_1\)</span> basis function which equals <span class="math notranslate nohighlight">\(1\)</span> at the red vertex and <span class="math notranslate nohighlight">\(0\)</span> on the others.</span><a class="headerlink" href="#id5" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Note that, as the size <span class="math notranslate nohighlight">\(h\)</span> of the mesh <span class="math notranslate nohighlight">\(\calT_h\)</span> tends to <span class="math notranslate nohighlight">\(0\)</span> – i.e. <span class="math notranslate nohighlight">\(\calT_h\)</span> is refined – it is expected that the subspace <span class="math notranslate nohighlight">\(V_h\)</span> becomes a closer approximation of the continuous space <span class="math notranslate nohighlight">\(V\)</span>.</p>
</section>
<section id="the-discrete-variational-problem">
<span id="sec-discvarpb"></span><h2><span class="section-number">1.3.3. </span>The discrete variational problem<a class="headerlink" href="#the-discrete-variational-problem" title="Link to this heading">¶</a></h2>
<p>The Finite Element discretization of the continuous variational problem <a class="reference internal" href="#equation-eq-varpbfe">(1.14)</a> is simply obtained by casting its variational formulation over the finite-dimensional space <span class="math notranslate nohighlight">\(V_h\)</span>: <span class="math notranslate nohighlight">\(u_h\)</span> is sought within <span class="math notranslate nohighlight">\(V_h\)</span> and the test functions <span class="math notranslate nohighlight">\(v_h\)</span> are taken in the same space, which yields:</p>
<div class="math notranslate nohighlight" id="equation-eq-discfv">
<span class="eqno">(1.17)<a class="headerlink" href="#equation-eq-discfv" title="Link to this equation">¶</a></span>\[\text{Search for } u_h \in V_h \text{ such that: } \forall v_h \in V_h, \:\: a(u_h,v_h) = \ell(v_h).\]</div>
<p>Let us decompose the sought function <span class="math notranslate nohighlight">\(u_h\)</span> on the selected basis <span class="math notranslate nohighlight">\(\left\{ \phi_i \right\}_{i=1,...,N_{V_h}}\)</span> of <span class="math notranslate nohighlight">\(V_h\)</span>, as in <a class="reference internal" href="#equation-eq-decompfebasis">(1.16)</a>. The discrete variational problem <a class="reference internal" href="#equation-eq-discfv">(1.17)</a> is equivalent to</p>
<p><div class="math notranslate nohighlight">
\[\text{ Search for } (u_1,..., u_{N_{V_h}}) \in \mathbb{R}^{N_{V_h}} \text{ s.t. }\quad \forall v_h \in V_h, \:\: \:\: \sum\limits_{j=1}^{N_{V_h}}{u_j a(\phi_j,v_h)} = \ell(v_h).\]</div>
</p>
<p>Since <span class="math notranslate nohighlight">\(\left\{ \phi_i \right\}_{i=1,...,N_{V_h}}\)</span> is a basis of <span class="math notranslate nohighlight">\(V_h\)</span> and since the mappings <span class="math notranslate nohighlight">\(a(\phi_j,\cdot)\)</span> and <span class="math notranslate nohighlight">\(\ell(\cdot)\)</span> are linear, it is equivalent to require that the above statement hold true for <span class="math notranslate nohighlight">\(v_h= \phi_1,\ldots,\phi_{N_{V_h}}\)</span>:</p>
<p><div class="math notranslate nohighlight">
\[\text{ Search for } (u_1,..., u_{N_{V_h}}) \in \mathbb{R}^{N_{V_h}} \text{ s.t. }\quad \forall i=1,...,N_{V_h}, \:\:\:\: \sum\limits_{j=1}^{N_{V_h}}{u_j a(\phi_j,\phi_i)} = \ell(\phi_i).\]</div>
</p>
<p>This is a linear system for the <span class="math notranslate nohighlight">\(N_{V_h}\)</span> unknown coefficients <span class="math notranslate nohighlight">\(u_1,\ldots,u_{N_{V_h}}\)</span>, which features <span class="math notranslate nohighlight">\(N_{V_h}\)</span> equations. In order to write it under matrix form, let <span class="math notranslate nohighlight">\(\bU_h = (u_1,...,u_{N_{V_h}}) \in \mathbb{R}^{N_{V_h}}\)</span> be the vector of the components of <span class="math notranslate nohighlight">\(u_h\)</span> in the basis <span class="math notranslate nohighlight">\(\left\{ \phi_i \right\}_{i=1,\ldots,N_{V_h}}\)</span>; we obtain:</p>
<div class="math notranslate nohighlight" id="equation-eq-ku-f">
<span class="eqno">(1.18)<a class="headerlink" href="#equation-eq-ku-f" title="Link to this equation">¶</a></span>\[ \text{Search for } \bU_h \in \mathbb{R}^{N_{V_h}} \:\: \text{ s.t. } \:\: K_h \bU_h = \bF_h,\]</div>
<p>where <span class="math notranslate nohighlight">\(K_h\)</span> is the <span class="math notranslate nohighlight">\(N_{V_h} \times N_{V_h}\)</span> stiffness matrix, and <span class="math notranslate nohighlight">\(\bF_h \in\mathbb{R}^{N_{V_h}}\)</span> is defined by:</p>
<div class="math notranslate nohighlight" id="equation-eq-defkf">
<span class="eqno">(1.19)<a class="headerlink" href="#equation-eq-defkf" title="Link to this equation">¶</a></span>\[(K_h)_{ij} = a(\phi_j,\phi_i), \:\: (F_h)_i = \ell(\phi_i), \:\: i,j=1,...,N_{V_h}.\]</div>
<div class="proof remark admonition" id="remark-2">
<p class="admonition-title"><span class="caption-number">Remark 1.5 </span></p>
<section class="remark-content" id="proof-content">
<p>The linear system <a class="reference internal" href="#equation-eq-ku-f">(1.18)</a> is usually very large: the matrix <span class="math notranslate nohighlight">\(K_h\)</span> has size <span class="math notranslate nohighlight">\(N_{V_h} \times N_{V_h}\)</span>, where the number <span class="math notranslate nohighlight">\(N_{V_h}\)</span> of degrees of freedom of the Finite Element method may be very large (especially in 3d). However, this system is fortunately very sparse: for a given index <span class="math notranslate nohighlight">\(i \in \left\{1,\ldots,N_{V_h}\right\}\)</span>, only very few of the coefficients <span class="math notranslate nohighlight">\((K_h)_{ij}\)</span> differ from <span class="math notranslate nohighlight">\(0\)</span>. This important property is due to the very &quot;local&quot; nature of the chosen basis <span class="math notranslate nohighlight">\(\left\{ \phi_i \right\}_{i=1,...,N_{V_h}}\)</span> for the Finite Element space at stake.</p>
</section>
</div><p>Let us now wonder about the invertibility of this system. The above reasoning has shown that <a class="reference internal" href="#equation-eq-defkf">(1.19)</a> is equivalent to the discrete variational problem <a class="reference internal" href="#equation-eq-discfv">(1.17)</a>. However, the latter is well-posed, as it satisfies all the assumptions of the <a class="reference internal" href="varpbs.html#th-laxmilgram"><span class="std std-ref">Lax-Milgram theorem</span></a>:</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(V_h\)</span> is certainly a Hilbert space, as it is finite-dimensional;</p></li>
<li><p><span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(\ell\)</span> are identical to the ingredients of the continuous variational problem <a class="reference internal" href="#equation-eq-varpbfe">(1.14)</a>, and so they are still respectively bilinear and linear, continuous, and <span class="math notranslate nohighlight">\(a\)</span> is coercive.</p></li>
</ul>
</div></blockquote>
<p>As a result, <a class="reference internal" href="#equation-eq-discfv">(1.17)</a> is well-posed, and so the linear system <a class="reference internal" href="#equation-eq-defkf">(1.19)</a> is invertible.</p>
<div class="proof remark admonition" id="remark-3">
<p class="admonition-title"><span class="caption-number">Remark 1.6 </span></p>
<section class="remark-content" id="proof-content">
<p>Loosely speaking, when the well-posedness of a continuous variational problem is guaranteed by the Lax-Milgram theorem, the well-posedness of the discretized one follows immediately, since the validity of the assumptions of this theorem in the continuous case automatically imply that they are also verified in the discretized setting. This is in sharp contrast with the more general setting of saddle-point problems involved in the treatment of the Stokes equations.</p>
</section>
</div></section>
<section id="convergence-of-the-finite-element-method">
<span id="sec-fecv"></span><h2><span class="section-number">1.3.4. </span>Convergence of the finite element method<a class="headerlink" href="#convergence-of-the-finite-element-method" title="Link to this heading">¶</a></h2>
<p>So far, the Finite Element Method has been an intuitive, but formal means to approximate the variational problem <a class="reference internal" href="#equation-eq-varpbfe">(1.14)</a>. It is a crucial question to elucidate under which conditions
the numerical solution <span class="math notranslate nohighlight">\(u_h\)</span> converges to the continuous one, <span class="math notranslate nohighlight">\(u\)</span>, when the size <span class="math notranslate nohighlight">\(h\)</span> of the mesh <span class="math notranslate nohighlight">\(\calT_h\)</span> tends to <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>The key result in this perspective is the following lemma.</p>
<div class="proof theorem admonition" id="theorem-4">
<p class="admonition-title"><span class="caption-number">Theorem 1.4 </span> (Céa’s lemma)</p>
<section class="theorem-content" id="proof-content">
<p>There exists a constant <span class="math notranslate nohighlight">\(C&gt;0\)</span> which does not depend on <span class="math notranslate nohighlight">\(h\)</span> such that the respective solutions <span class="math notranslate nohighlight">\(u\)</span>, <span class="math notranslate nohighlight">\(u_h\)</span> to <a class="reference internal" href="#equation-eq-varpbfe">(1.14)</a> and <a class="reference internal" href="#equation-eq-discfv">(1.17)</a> satisfy:</p>
<div class="math notranslate nohighlight" id="equation-eq-cea">
<span class="eqno">(1.20)<a class="headerlink" href="#equation-eq-cea" title="Link to this equation">¶</a></span>\[ \lvert\lvert u - u_h \lvert\lvert_V \: \leq \: C \inf\limits_{v_h \in V_h}{\lvert\lvert u-v_h \lvert\lvert}.\]</div>
</section>
</div><div class="dropdown admonition">
<p class="admonition-title">Proof</p>
<p>The variational problem satisfied by <span class="math notranslate nohighlight">\(u\)</span> implies in particular that:</p>
<p><div class="math notranslate nohighlight">
\[\forall v_h \in V_h, \:\: a(u,v_h) = \ell(v_h).\]</div>
</p>
<p>On the other hand, the discrete variational problem for <span class="math notranslate nohighlight">\(u_h\)</span> reads:</p>
<p><div class="math notranslate nohighlight">
\[\forall v_h \in V_h, \:\: a(u_h,v_h)  = \ell(v_h).\]</div>
</p>
<p>Subtracting one of these relations from the other, we obtain:</p>
<p><div class="math notranslate nohighlight">
\[\forall v_h \in V_h, \:\: a(u-u_h, v_h) = 0.\]</div>
</p>
<p>It follows that, for an arbitrary element <span class="math notranslate nohighlight">\(v_h \in V_h\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ccl}
 \alpha || u-u_h || ^2 &amp;\leq &amp; a(u-u_h,u-u_h)\\
 &amp;=&amp; a(u-u_h,u-v_h) \\
 &amp;\leq&amp; M || u-u_h ||_V || u - v_h ||_V.
\end{array}\end{split}\]</div>
<p>Since this holds true for arbitrary <span class="math notranslate nohighlight">\(v_h \in V_h\)</span>, we may take the infimum in the above right-hand side, which yields:</p>
<p><div class="math notranslate nohighlight">
\[\lvert\lvert u-u_h \lvert\lvert_V \leq \frac{M}{\alpha} \inf\limits_{v_h \in V_h} \lvert\lvert u-v_h \lvert\lvert_V,\]</div>
</p>
<p>which is the desired result with <span class="math notranslate nohighlight">\(C = M/\alpha\)</span>.</p>
</div>
<p>Intuitively, Céa’s lemma states that the Finite Element approximation <span class="math notranslate nohighlight">\(u_h\)</span> of the solution <span class="math notranslate nohighlight">\(u\)</span> to <a class="reference internal" href="#equation-eq-varpbfe">(1.14)</a> is &quot;almost&quot; the best approximation of <span class="math notranslate nohighlight">\(u\)</span> by a function in <span class="math notranslate nohighlight">\(V_h\)</span>. Hence, the convergence of <span class="math notranslate nohighlight">\(u_h\)</span> to <span class="math notranslate nohighlight">\(u\)</span> as the mesh is refined is controlled by the “approximation capabilities&quot; of the functional space <span class="math notranslate nohighlight">\(V\)</span> by the discrete counterpart <span class="math notranslate nohighlight">\(V_h\)</span>.</p>
<p>Without entering into mathematical details, let us state an archetypal convergence result of the Finite Element Method allowed by this lemma.</p>
<div class="proof proposition admonition" id="proposition-5">
<p class="admonition-title"><span class="caption-number">Proposition 1.12 </span></p>
<section class="proposition-content" id="proof-content">
<p>Assume that <span class="math notranslate nohighlight">\(\Omega\)</span> is a polygonal domain in <span class="math notranslate nohighlight">\(\R^d\)</span> (<span class="math notranslate nohighlight">\(d=2\)</span> or <span class="math notranslate nohighlight">\(3\)</span>), and let <span class="math notranslate nohighlight">\({\mathcal T}_h\)</span> be a sequence of meshes of <span class="math notranslate nohighlight">\(\Omega\)</span>, indexed by the maximum size <span class="math notranslate nohighlight">\(h = \max_{T \in \calT_h} \text{diam}(T)\)</span> of a simplex in the mesh. We assume that:</p>
<blockquote>
<div><ul>
<li><p>The size <span class="math notranslate nohighlight">\(h\)</span> of <span class="math notranslate nohighlight">\(\calT_h\)</span> converges to <span class="math notranslate nohighlight">\(0\)</span>.</p></li>
<li><p>The quality of the mesh <span class="math notranslate nohighlight">\(\calT_h\)</span> does not degenerate, i.e.</p>
<p><div class="math notranslate nohighlight">
\[\text{There exists a constant } C &gt;0 \text{ independent of } h \text{ s.t }\quad 1 \leq \frac{\text{diam}(T)}{\rho(T)} \leq C.\]</div>
</p>
</li>
</ul>
</div></blockquote>
<p>Then, the Lagrange Finite Element Method <span class="math notranslate nohighlight">\(\mathbb{P}_k\)</span> converges for <span class="math notranslate nohighlight">\(k \geq 1\)</span>, i.e.</p>
<p><div class="math notranslate nohighlight">
\[\lim\limits_{h \to 0} \lvert\lvert u- u_h \lvert\lvert_{H^1(\Omega)} \xrightarrow{h \to 0} 0.\]</div>
</p>
<p>Moreover, assuming that <span class="math notranslate nohighlight">\(u\)</span> belongs to <span class="math notranslate nohighlight">\(H^{k+1}(\Omega)\)</span>, there exists a constant <span class="math notranslate nohighlight">\(C &gt;0\)</span> such that:</p>
<p><div class="math notranslate nohighlight">
\[\lvert\lvert u- u_h \lvert\lvert_{H^1(\Omega)} \leq C h^k \lvert\lvert u \lvert\lvert_{H^{k+1}(\Omega)}.  \]</div>
</p>
</section>
</div></section>
<section id="towards-implementation-of-the-method">
<h2><span class="section-number">1.3.5. </span>Towards implementation of the method<a class="headerlink" href="#towards-implementation-of-the-method" title="Link to this heading">¶</a></h2>
<p>Once an appropriate Finite Element space <span class="math notranslate nohighlight">\(V_h\)</span> is chosen, the solution of the variational problem <a class="reference internal" href="#equation-eq-ku-f">(1.18)</a> by the Finite Element Method proceeds in two main steps:</p>
<blockquote>
<div><ul class="simple">
<li><p>One first needs to assemble the system, i.e. to calculate the entries <span class="math notranslate nohighlight">\(K_{ij}\)</span> of the stiffness matrix and those <span class="math notranslate nohighlight">\(b_i\)</span> of the right-hand side, see the formulas <a class="reference internal" href="#equation-eq-defkf">(1.19)</a>;</p></li>
<li><p>One then needs to solve the large (but sparse) linear system <a class="reference internal" href="#equation-eq-ku-f">(1.18)</a>.</p></li>
</ul>
</div></blockquote>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/falcmill.png" alt="Logo" />
    
  </a>
</p>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index_gen.html">1. Generalities</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="anafunc.html">1.1. Functional analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="varpbs.html">1.2. Lax-Milgram framework</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.3. The Finite Element method</a></li>
<li class="toctree-l2"><a class="reference internal" href="laplace.html">1.4. Laplace equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">1.5. Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="mesh.html">1.6. Meshes</a></li>
<li class="toctree-l2"><a class="reference internal" href="eigen.html">1.7. Eigenvalues</a></li>
<li class="toctree-l2"><a class="reference internal" href="dirpen.html">1.8. Penalization for Dirichlet conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="laplace_pure_Neumann.html">1.9. Pure Neumann</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Advanced/index_adv.html">2. Advanced features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Structure_Mechanics/index_structmech.html">3. Structure mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Fluid_Mechanics/index_fl.html">4. Fluid mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Optimal_design/index_od.html">5. Optimal design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Appendix/index_app.html">6. Appendix</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">7. Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">8. Glossary</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index_gen.html"><span class="section-number">1. </span>Getting started</a><ul>
      <li>Previous: <a href="varpbs.html" title="previous chapter"><span class="section-number">1.2. </span>The Lax-Milgram variational theory</a></li>
      <li>Next: <a href="laplace.html" title="next chapter"><span class="section-number">1.4. </span>The Laplace equation in all its forms</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;.
      
      |
      <a href="../_sources/Generalities/FEtheory.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>